<!DOCTYPE html>
<html>
  <head>
    <script src="./node_modules/angular/angular.min.js"></script>
    <script src="./node_modules/angular-animate/angular-animate.min.js"></script>
    <script src="./node_modules/angular-aria/angular-aria.min.js"></script>
    <script src="./node_modules/angular-material/angular-material.min.js"></script>
    <script src="./node_modules/angular-messages/angular-messages.min.js"></script>
    <script src="./node_modules/angular-sanitize/angular-sanitize.min.js"></script>
    <link rel="stylesheet" href="./node_modules/angular-material/angular-material.min.css">
    <script type="application/javascript" src="script.js"></script>
  </head>
  <body>
    
    <div ng-controller="AppCtrl as ctrl" 
     ng-cloak="" 
     class="carddemoBasicUsage" 
     ng-app="MyApp">
  
  <div layout="column" >
  
    <md-toolbar>
      <div class="md-toolbar-tools">
      </div>
    </md-toolbar>
    
    <md-content class="md-padding" layout="column">
      
      <div class="cb-container">
        
        <div class="md-whiteframe-1dp" ng-controller="QueryBuilderCtrl">
          <md-toolbar>
            <div class="md-toolbar-tools">
              <p class="md-subhead">Create a new filter</p>
            </div>
          </md-toolbar>
          <md-content>
            <div class="md-padding">
              <span>Items match</span>
              <md-button class="md-raised">All</md-button>
              <span>of the following conditions:</span>
            </div>
            <md-divider></md-divider>
          
            <div layout="row" class="md-padding">
              <query-builder group="filter.group" flex></query-builder>
            </div>
            
            <div layout="row" class="md-padding">
              <span ng-bind-html="output"></span>
            </div>
            
            <div class="md-toolbar-tools">
              <p class="md-subhead">Create a new segment</p>
            </div>
          </md-content>
        </div> <!-- END OF QueryBuilderCtrl -->
      </div> <!-- END OF .cb-container -->
    </md-content>
  </div>
  
  
<script type="text/ng-template" id="queryBuilderDirective.html">
<div flex>
  
  <div flex layout="row" layout-align="start center">
    <md-input-container>
      <label>Property</label>
      <md-select ng-model="group.operator" placeholder="Choose property">
        <md-option ng-repeat="op in operators" ng-value="op.name">
          {{op.name}}
        </md-option>
      </md-select>
    </md-input-container>
  
  <!-- Only conditions can be added -->
    <md-button 
      ng-click="addCondition()" 
      class="md-primary md-raised">
      Add Condition
    </md-button>
  </div>
  
  <!-- =============================================================== -->
  <!-- Creates a new row when "Add Condition" is cliked -->
  <div class="group-conditions">
    <div ng-repeat="rule in group.rules | orderBy:'index'" class="condition">
      <div ng-switch="rule.hasOwnProperty('group')">
        <div ng-switch-when="true">
          <query-builder flex group="rule.group"></query-builder>
        </div>
        <div ng-switch-default="ng-switch-default">
          <div layout="row">
            
            <!-- Button that removes condition -->
            <md-button 
              class="md-icon-button" 
              style="margin-top:18px;"
              ng-click="removeCondition($index)">
              <md-icon class="material-icons">remove_circle_outline</md-icon>
            </md-button>
  
            <!-- Input for fields (columns) in which data is searched -->
            <md-input-container flex="20">
              <label>Field</label>
              <md-select ng-model="rule.field" placeholder="Choose property">
                <md-option ng-repeat="f in fields" ng-value="f.name">
                  {{f.name}}
                </md-option>
              </md-select>
            </md-input-container>
    
            <!-- Select condition type as SQL condition -->
            <md-input-container flex="10">
              <label>Condition</label>
              <md-select ng-model="rule.condition" placeholder="Choose property">
                <md-option ng-repeat="c in conditions" ng-value="c.name">
                  {{c.name}}
                </md-option>
              </md-select>
            </md-input-container>
            
            <!-- What are you looking for. This field should be dynamic 
            and change based on what type of data you want to search -->
            <md-input-container>
              <label>Value</label>
              <input ng-model="rule.data">
            </md-input-container>
  
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</script>  
</div>

  </body>
</html>





